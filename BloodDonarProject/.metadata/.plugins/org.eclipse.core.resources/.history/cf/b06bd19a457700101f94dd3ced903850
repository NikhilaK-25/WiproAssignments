package com.nk.wipro.services;


import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;

import com.nk.wipro.entity.Donor;

import com.nk.wipro.exception.DonorNotFoundException;
import com.nk.wipro.repo.DonorRepository;

import java.util.List;

@Service
@RequiredArgsConstructor
public class DonorServiceImpl implements DonorService {

    private final DonorRepository donorRepository;

    @Override
    public Donor addDonor(Donor donor) {
        return donorRepository.save(donor);
    }

    @Override
    public Donor updateDonor(Long id, Donor donor) {
        Donor existing = donorRepository.findById(id)
                .orElseThrow(() -> new RuntimeException("Donor not found"));
        existing.setName(donor.getName());
        existing.setBloodGroup(donor.getBloodGroup());
        existing.setCity(donor.getCity());
        existing.setCompany(donor.getCompany());
        existing.setAge(donor.getAge());
        existing.setEmail(donor.getEmail());
        return donorRepository.save(existing);
    }

    @Override
    public List<Donor> getDonorsByBloodGroup(String bloodGroup) {
        return donorRepository.findByBloodGroup(bloodGroup);
    }

    @Override
    public List<Donor> getDonorsByCity(String city) {
        return donorRepository.findByCity(city);
    }

    @Override
    public List<Donor> getDonorsByCompany(String company) {
        return donorRepository.findByCompany(company);
    }

    @Override
    public void deleteDonor(Long id) {
        Donor existing = donorRepository.findById(id)
                .orElseThrow(() -> new DonorNotFoundException(id));
        donorRepository.delete(existing);
    }
}
